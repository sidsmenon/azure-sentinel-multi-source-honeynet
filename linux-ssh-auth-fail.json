{
    "version": "Notebook/1.0",
    "items": [
        {
            "type": 1,
            "content": {
                "json": "## New workbook\n---\n\nWelcome to your new workbook.  This area will display text formatted as markdown.\n\n\nWe've included a basic analytics query to get you started. Use the `Edit` button below each section to configure it or add more sections."
            },
            "name": "text - 2",
            "id": "420e8227-0226-42bc-9bc5-bb64adfec55f"
        },
        {
            "id": "4eba601b-f4db-4e3c-9226-1e86c377aef5",
            "type": 3,
            "name": "query - 0",
            "content": {
                "version": "KqlItem/1.0",
                "query": "let GeoIPDB_FULL = _GetWatchlist(\"geoip\");\nlet IpAddress_REGEX_PATTERN = @\"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b\";\nSyslog\n| where Facility == \"auth\"\n| where SyslogMessage startswith \"Failed password for\"\n| order by TimeGenerated desc\n| project TimeGenerated, SourceIP = extract(IpAddress_REGEX_PATTERN, 0, SyslogMessage), DestinationHostName = HostName, DestinationIP = HostIP, Facility, SyslogMessage, ProcessName, SeverityLevel, Type\n| evaluate ipv4_lookup(GeoIPDB_FULL, SourceIP, network)\n| project TimeGenerated, SourceIP, DestinationHostName, DestinationIP, Facility, SyslogMessage, ProcessName, SeverityLevel, Type, latitude, longitude, city = cityname, country = countryname, friendly_location = strcat(cityname, \" (\", countryname, \")\");",
                "size": 3,
                "timeContext": {
                    "durationMs": 2592000000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "map",
                "mapSettings": {
                    "locInfo": "LatLong",
                    "locInfoColumn": "countryname",
                    "latitude": "latitude",
                    "longitude": "longitude",
                    "sizeSettings": "latitude",
                    "sizeAggregation": "Count",
                    "opacity": 0.8,
                    "labelSettings": "friendly_location",
                    "legendMetric": "friendly_location",
                    "legendAggregation": "Count",
                    "itemColorSettings": {
                        "nodeColorField": "latitude",
                        "colorAggregation": "Count",
                        "type": "heatmap",
                        "heatmapPalette": "greenRed"
                    }
                },
                "crossComponentResources": [
                    "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
                ]
            }
        }
    ],
    "isLocked": false,
    "styleSettings": {},
    "fromTemplateId": "sentinel-UserWorkbook",
    "context": {
        "ownerId": "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourceGroups/honeynet-rg/providers/Microsoft.OperationalInsights/workspaces/honeynet-law"
    },
    "fallbackResourceIds": [
        "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
    ]
}