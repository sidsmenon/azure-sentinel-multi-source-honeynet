{
    "version": "Notebook/1.0",
    "items": [
        {
            "type": 1,
            "content": {
                "json": "## New workbook\n---\n\nWelcome to your new workbook.  This area will display text formatted as markdown.\n\n\nWe've included a basic analytics query to get you started. Use the `Edit` button below each section to configure it or add more sections."
            },
            "name": "text - 2",
            "id": "340fe309-4b82-448e-a0f7-4148b6e94f29"
        },
        {
            "id": "247abec8-b109-4cf9-a77b-5531fb653235",
            "type": 3,
            "name": "query - 0",
            "content": {
                "version": "KqlItem/1.0",
                "query": "let GeoIPDB_FULL = _GetWatchlist(\"geoip\");\nNTANetAnalytics\n| where TimeGenerated > ago(30d)\n| where tolower(SubType) == \"flowlog\"\n| where FlowType == \"MaliciousFlow\"\n| order by TimeGenerated desc\n| project\n    TimeGenerated,\n    FlowType,\n    IpAddress = SrcIp,\n    DestinationIpAddress = DestIp,\n    DestinationPort = DestPort,\n    Protocol = L7Protocol,\n    NSGRuleMatched = AclRule\n| evaluate ipv4_lookup(GeoIPDB_FULL, IpAddress, network)\n| project\n    TimeGenerated,\n    FlowType,\n    IpAddress,\n    DestinationIpAddress,\n    DestinationPort,\n    Protocol,\n    NSGRuleMatched,\n    latitude,\n    longitude,\n    countryname,\n    cityname,\n    city = cityname,\n    country = countryname,\n    friendly_location = strcat(cityname, \" (\", countryname, \")\")\n| order by TimeGenerated desc",
                "size": 3,
                "timeContext": {
                    "durationMs": 2592000000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "map",
                "mapSettings": {
                    "locInfo": "LatLong",
                    "locInfoColumn": "countryname",
                    "latitude": "latitude",
                    "longitude": "longitude",
                    "sizeSettings": "city",
                    "sizeAggregation": "Count",
                    "opacity": 0.8,
                    "labelSettings": "friendly_location",
                    "legendMetric": "IpAddress",
                    "legendAggregation": "Count",
                    "itemColorSettings": {
                        "nodeColorField": "city",
                        "colorAggregation": "Count",
                        "type": "heatmap",
                        "heatmapPalette": "greenRed"
                    }
                },
                "crossComponentResources": [
                    "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
                ]
            }
        }
    ],
    "isLocked": false,
    "styleSettings": {},
    "fromTemplateId": "sentinel-UserWorkbook",
    "context": {
        "ownerId": "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourceGroups/honeynet-rg/providers/Microsoft.OperationalInsights/workspaces/honeynet-law"
    },
    "fallbackResourceIds": [
        "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
    ]
}