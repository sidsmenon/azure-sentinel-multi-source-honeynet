{
    "version": "Notebook/1.0",
    "items": [
        {
            "type": 1,
            "content": {
                "json": "## New workbook\n---\n\nWelcome to your new workbook.  This area will display text formatted as markdown.\n\n\nWe've included a basic analytics query to get you started. Use the `Edit` button below each section to configure it or add more sections."
            },
            "name": "text - 2",
            "id": "3b121f9a-77c9-496b-b47a-bd1a9893f85e"
        },
        {
            "id": "bfec18be-b24c-4e97-b2c0-73278fc72a33",
            "type": 3,
            "name": "query - 0",
            "content": {
                "version": "KqlItem/1.0",
                "query": "let GeoIPDB_FULL = _GetWatchlist(\"geoip\");\nlet IpAddress_REGEX_PATTERN = @\"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b\";\n// Brute Force Attempt MS SQL Server\nEvent\n| where EventLog == \"Application\"\n| where EventID == 18456\n| project TimeGenerated, AttackerIP = extract(IpAddress_REGEX_PATTERN, 0, RenderedDescription), DestinationHostName = Computer, RenderedDescription\n| evaluate ipv4_lookup(GeoIPDB_FULL, AttackerIP, network)\n| project TimeGenerated, AttackerIP, DestinationHostName, RenderedDescription, latitude, longitude, city = cityname, country = countryname, friendly_location = strcat(cityname, \" (\", countryname, \")\");",
                "size": 3,
                "timeContext": {
                    "durationMs": 2592000000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "map",
                "mapSettings": {
                    "locInfo": "LatLong",
                    "locInfoColumn": "countryname",
                    "latitude": "latitude",
                    "longitude": "longitude",
                    "sizeSettings": "latitude",
                    "sizeAggregation": "Count",
                    "opacity": 0.8,
                    "labelSettings": "friendly_location",
                    "legendMetric": "friendly_location",
                    "legendAggregation": "Count",
                    "itemColorSettings": {
                        "nodeColorField": "latitude",
                        "colorAggregation": "Sum",
                        "type": "heatmap",
                        "heatmapPalette": "greenRed"
                    }
                },
                "crossComponentResources": [
                    "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
                ]
            }
        }
    ],
    "isLocked": false,
    "styleSettings": {},
    "fromTemplateId": "sentinel-UserWorkbook",
    "context": {
        "ownerId": "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourceGroups/honeynet-rg/providers/Microsoft.OperationalInsights/workspaces/honeynet-law"
    },
    "fallbackResourceIds": [
        "/subscriptions/fe9ee672-6512-460a-a659-87c74c035ea5/resourcegroups/honeynet-rg/providers/microsoft.operationalinsights/workspaces/honeynet-law"
    ]
}